<div class="container" style="max-width:720px;margin:16px auto;">
  <h2>Reactive Form</h2>

  <form [formGroup]="profileForm" (ngSubmit)="onSubmit()" novalidate>
    <div style="display:grid;gap:12px;">
      <!-- Username -->
      <div>
        <label for="username">Username</label>
        <input id="username" type="text" formControlName="username" />
        <div class="error" *ngIf="username?.invalid && (username?.dirty || username?.touched)">
          <small *ngIf="username?.errors?.['required']">Username is required.</small>
          <small *ngIf="username?.errors?.['minlength']">Min 3 characters.</small>
          <small *ngIf="username?.pending">Checking availability...</small>
          <small *ngIf="username?.errors?.['usernameTaken']">Username already taken.</small>
        </div>
      </div>

      <!-- Email -->
      <div>
        <label for="email">Email</label>
        <input id="email" type="email" formControlName="email" />
        <div class="error" *ngIf="email?.invalid && (email?.dirty || email?.touched)">
          <small *ngIf="email?.errors?.['required']">Email is required.</small>
          <small *ngIf="email?.errors?.['email']">Enter a valid email.</small>
        </div>
      </div>

      <!-- Age -->
      <div>
        <label for="age">Age</label>
        <input id="age" type="number" formControlName="age" />
        <div class="error" *ngIf="age?.invalid && (age?.dirty || age?.touched)">
          <small *ngIf="age?.errors?.['required']">Age is required.</small>
          <small *ngIf="age?.errors?.['min']">Minimum is 1.</small>
          <small *ngIf="age?.errors?.['max']">Maximum is 120.</small>
        </div>
      </div>

      <!-- Gender -->
      <div>
        <label for="gender">Gender</label>
        <select id="gender" formControlName="gender">
          <option value="" disabled>Select gender</option>
          <option value="male">Male</option>
          <option value="female">Female</option>
          <option value="other">Other</option>
        </select>
        <div class="error" *ngIf="gender?.invalid && (gender?.dirty || gender?.touched)">
          <small *ngIf="gender?.errors?.['required']">Gender is required.</small>
        </div>
      </div>

      <!-- Passwords -->
      <div>
        <label for="password">Password</label>
        <input id="password" type="password" formControlName="password" />
        <div class="error" *ngIf="password?.invalid && (password?.dirty || password?.touched)">
          <small *ngIf="password?.errors?.['required']">Password is required.</small>
          <small *ngIf="password?.errors?.['minlength']">Min 6 characters.</small>
        </div>
      </div>

      <div>
        <label for="confirmPassword">Confirm Password</label>
        <input id="confirmPassword" type="password" formControlName="confirmPassword" />
        <div class="error" *ngIf="(confirmPassword?.dirty || confirmPassword?.touched) && profileForm.errors?.['passwordsMismatch']">
          <small>Passwords do not match.</small>
        </div>
      </div>

      <!-- Address group -->
      <fieldset formGroupName="address" style="padding:8px;border:1px solid #ddd;">
        <legend>Address</legend>
        <div>
          <label for="street">Street</label>
          <input id="street" type="text" formControlName="street" />
          <div class="error" *ngIf="street?.invalid && (street?.dirty || street?.touched)">
            <small *ngIf="street?.errors?.['required']">Street is required.</small>
          </div>
        </div>
        <div>
          <label for="city">City</label>
          <input id="city" type="text" formControlName="city" />
          <div class="error" *ngIf="city?.invalid && (city?.dirty || city?.touched)">
            <small *ngIf="city?.errors?.['required']">City is required.</small>
          </div>
        </div>
        <div>
          <label for="zip">ZIP</label>
          <input id="zip" type="text" formControlName="zip" />
          <div class="error" *ngIf="zip?.invalid && (zip?.dirty || zip?.touched)">
            <small *ngIf="zip?.errors?.['required']">ZIP is required.</small>
            <small *ngIf="zip?.errors?.['pattern']">ZIP must be 5 digits.</small>
          </div>
        </div>
      </fieldset>

      <!-- Dynamic skills -->
      <div formArrayName="skills" style="border:1px dashed #ccc;padding:8px;">
        <div style="display:flex;justify-content:space-between;align-items:center;">
          <strong>Skills</strong>
          <button type="button" (click)="addSkill()">Add Skill</button>
        </div>
        <div *ngFor="let ctrl of skills.controls; let i = index" style="display:flex;gap:8px;align-items:center;margin-top:8px;">
          <input [formControlName]="i" placeholder="e.g. Angular" />
          <button type="button" (click)="removeSkill(i)">Remove</button>
          <div class="error" *ngIf="ctrl.invalid && (ctrl.dirty || ctrl.touched)">
            <small *ngIf="ctrl.errors?.['required']">Required</small>
            <small *ngIf="ctrl.errors?.['minlength']">Min 2 characters</small>
          </div>
        </div>
      </div>

      <!-- Terms -->
      <div>
        <label>
          <input type="checkbox" formControlName="terms" />
          I accept the terms
        </label>
        <div class="error" *ngIf="terms?.invalid && (terms?.dirty || terms?.touched)">
          <small>You must accept the terms.</small>
        </div>
      </div>

      <!-- Form state -->
      <div>
        <small>Valid: {{ profileForm.valid }}</small> |
        <small>Dirty: {{ profileForm.dirty }}</small>
      </div>

      <div style="display:flex;gap:8px;">
        <button type="submit" [disabled]="profileForm.invalid || profileForm.pending">Submit</button>
        <button type="button" (click)="reset()">Reset</button>
      </div>
    </div>
  </form>
</div>
